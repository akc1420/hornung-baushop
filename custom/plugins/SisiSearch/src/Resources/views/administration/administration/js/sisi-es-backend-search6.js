(this.webpackJsonp=this.webpackJsonp||[]).push([["sisi-es-backend-search6"],{3100:function(e,t,n){"use strict";n.r(t);var i=n("FcZK"),r=n.n(i);const{Component:s}=Shopware;s.override("sw-settings-index",{template:r.a});var a=n("S3Ds"),c=n.n(a);n("G+ND");const{Component:o}=Shopware,{Criteria:l}=Shopware.Data;o.register("sisi-backend-search-list",{template:c.a,name:"SisiBackendsearch",inject:["SisiEsBackendService"],metaInfo(){return{title:this.$createTitle()}},data(){return{term:this.initialSearch,isSearchBarShown:!1,result:"",hoverEvent:!1,page:0,languageValue:[],shop:"",options:"",shopValue:"",language:"",error:!1,icon:"none"}},created(){this.getChannels()},methods:{sisisearch(){this.term=arguments[0];var e={term:this.term,page:0,shop:this.shopValue},t=this;this.term.length>1&&""!==this.shopValue&&(t.icon="block",this.SisiEsBackendService.sisisearch(e).then((e=>{this.result=e,this.error=!1,t.icon="none"})).catch((e=>{}))),""===this.shopValue&&(this.error=!0)},changeChannel(){this.result=""},getChannels(){this.SisiEsBackendService.channels().then((e=>{this.options=e.channel,this.language=e.language})).catch((e=>{}))},scrollFunction(){const e=this;for(var t=document.querySelectorAll(".sisi-last-row"),n=0;n<t.length;n++){e.isInViewport(t[n])&&this.load()}},isInViewport(e){const t=e.getBoundingClientRect();return!e.classList.contains("sisiIsvisible")&&(t.top>=0&&t.left>=0&&t.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&t.right<=(window.innerWidth||document.documentElement.clientWidth)&&(e.classList.add("sisiIsvisible"),!0))},load(){this.page=this.page+1;var e={term:this.term,page:this.page,shop:this.shopValue};this.SisiEsBackendService.sisisearch(e).then((e=>{var t=this.result.data.hits.hits,n=e.data.hits.hits;this.result.data.hits.hits=t.concat(n)})).catch((e=>{}))}}});var d=n("L+3a"),h=n("JxsJ");const{Module:u}=Shopware;u.register("sisi-backend-search",{type:"plugin",name:"sisiBackendSearch",title:"sisi-backend-search.title",description:"sisi-backend-search.title",version:"1.0.0",targetVersion:"1.0.0",color:"#9AA8B5",snippets:{"de-DE":d,"en-GB":h},routes:{list:{component:"sisi-backend-search-list",path:"list"}},navigation:[{id:"sisi-backend-search",label:"sisi-backend-search.initialSearchType",color:"#57D9A3",path:"sisi.backend.search.list",icon:"default-symbol-products",parent:"sw-catalogue",privilege:"product.viewer",position:11}]});var p=n("SwLI");class v extends p.default{constructor(e,t,n=""){super(e,t,n)}sisisearch(e){return this.httpClient.post("_action/sisi/backend/search",{config:e},{headers:this.getBasicHeaders()}).then((e=>e))}channels(){return this.httpClient.post("_action/sisi/backend/shop",{},{headers:this.getBasicHeaders()}).then((e=>p.default.handleResponse(e)))}}var g=v;const{Application:f}=Shopware;f.addServiceProvider("SisiEsBackendService",(e=>{const t=f.getContainer("init");return new g(t.httpClient,e.loginService)}));var b=n("fk1o"),m=n.n(b);const{Component:k,Application:w}=Shopware;Shopware.Utils;k.override("sw-search-bar",{template:m.a,methods:{resetSearchType(){}}})},CkOj:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var i=n("lSNA"),r=n.n(i),s=n("lO2t"),a=n("lYO9");function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){r()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e){var t=function(e){var t;if(s.a.isString(e))try{t=JSON.parse(e)}catch(e){return!1}else{if(!s.a.isObject(e)||s.a.isArray(e))return!1;t=e}return t}(e);if(!t)return null;if(!0===t.parsed||!function(e){return void 0!==e.data||void 0!==e.errors||void 0!==e.links||void 0!==e.meta}(t))return t;var n=function(e){var t={links:null,errors:null,data:null,associations:null,aggregations:null};if(e.errors)return t.errors=e.errors,t;var n=function(e){var t=new Map;if(!e||!e.length)return t;return e.forEach((function(e){var n="".concat(e.type,"-").concat(e.id);t.set(n,e)})),t}(e.included);if(s.a.isArray(e.data))t.data=e.data.map((function(e){var i=d(e,n);return Object(a.g)(i,"associationLinks")&&(t.associations=o(o({},t.associations),i.associationLinks),delete i.associationLinks),i}));else if(s.a.isObject(e.data)){var i=d(e.data,n);Object.prototype.hasOwnProperty.call(i,"associationLinks")&&(t.associations=o(o({},t.associations),i.associationLinks),delete i.associationLinks),t.data=i}else t.data=null;e.meta&&Object.keys(e.meta).length&&(t.meta=h(e.meta));e.links&&Object.keys(e.links).length&&(t.links=e.links);e.aggregations&&Object.keys(e.aggregations).length&&(t.aggregations=e.aggregations);return t}(t);return n.parsed=!0,n}function d(e,t){var n={id:e.id,type:e.type,links:e.links||{},meta:e.meta||{}};if(e.attributes&&Object.keys(e.attributes).length>0){var i=h(e.attributes);n=o(o({},n),i)}if(e.relationships){var r=function(e,t){var n={},i={};return Object.keys(e).forEach((function(r){var a=e[r];if(a.links&&Object.keys(a.links).length&&(i[r]=a.links.related),a.data){var c=a.data;s.a.isArray(c)?n[r]=c.map((function(e){return u(e,t)})):s.a.isObject(c)?n[r]=u(c,t):n[r]=null}})),{mappedRelations:n,associationLinks:i}}(e.relationships,t);n=o(o(o({},n),r.mappedRelations),{associationLinks:r.associationLinks})}return n}function h(e){var t={};return Object.keys(e).forEach((function(n){var i=e[n],r=n.replace(/-([a-z])/g,(function(e,t){return t.toUpperCase()}));t[r]=i})),t}function u(e,t){var n="".concat(e.type,"-").concat(e.id);return t.has(n)?d(t.get(n),t):e}},FcZK:function(e,t){e.exports='{% block sw_settings_content_card_slot_plugins %}\n    {% parent %}\n\n    <sw-settings-item id="sisi-backend-search"\n                      :label="$t(\'sisi-backend-search.backendlabel\')"\n                      :to="{ name: \'sisi.backend.search.list\' }">\n        <template slot="icon">\n            <sw-icon name="default-action-search"></sw-icon>\n        </template>\n    </sw-settings-item>\n\n{% endblock %}\n\n{% block  sw_search_bar_types_container %} {% endblock %}\n'},"G+ND":function(e,t,n){var i=n("pgcR");"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);(0,n("SZ7m").default)("79476c61",i,!0,{})},JxsJ:function(e){e.exports=JSON.parse('{"sisi-backend-search":{"result":"Search result","channel":"Channel selection","backendlabel":"Elasticsearch for backend","title":"Sisi backend search","noitem":"No item","hits":"Hits","productname":"Product name","productid":"Product ID","productdescription":"Product description","productnumber":"Product number","productean":"Product ean","productmetatitle":"Product meta title","placeholder":"Productname, productnumber, EAN or any random term","initialSearchType":"Elasticsearch product search","alert":"Please selected a channel"}}')},"L+3a":function(e){e.exports=JSON.parse('{"sisi-backend-search":{"result":"Suchergebnisse","channel":"Channelauswahl","backendlabel":"Backendsuche mit Elasticsearch","title":"Sisi Backendsuche","noitem":"Keine Treffer","hits":"Treffer","productname":"Produktname","productid":"Produkt ID","productdescription":"Produktbeschreibung","productnumber":"Produktnummer","productean":"Produkt EAN","productmetatitle":"Produkt Meta Titel","placeholder":"Produktname, Produktnummer, EAN oder ein beliebiger Begriff","initialSearchType":"Elasticsearch Produktsuche","alert":"Bitte einen Channel ausw√§hlen"}}')},S3Ds:function(e,t){e.exports='{% block sisi_backend_search_list %}\n    <sw-page class="sisi-backend-search">\n        <template #search-bar>\n        <sw-search-bar :initialSearchType="$t(\'sisi-backend-search.initialSearchType\')"\n                       initialSearch=""\n                       :placeholder= "$t(\'sisi-backend-search.placeholder\')"\n                       @search="sisisearch">\n        </sw-search-bar>\n        </template>\n        {% block sisi_fields_list_smart_bar_actions %}\n        {% endblock %}\n        <template slot="content">\n            {% block sisi_backend_search_list_content %}\n                <sw-card  large>\n                    <label> {{ $t(\'sisi-backend-search.channel\') }} </label>\n                    <select v-model="shopValue"   v-bind:class="{ sisired:error}" v-on:change="changeChannel()">\n                        <option v-for="(option,index) in options" v-bind:value="option.value">\n                            {{ option.text }}\n                        </option>\n                    </select>\n\n                    <sw-alert variant="info" appearance="false" :showIcon="true" :closable="false" class="sisi-alert sisinone"\n                              v-bind:class="{ sisired: error}">\n                        {{ $t(\'sisi-backend-search.alert\') }}\n                    </sw-alert>\n\n                </sw-card>\n                <div class="sisi-backend-result-wrapper">\n                 <sw-card  large v-if="result.data">\n                     <h2 v-if="result.data">{{ $t(\'sisi-backend-search.hits\') }}: {{ result.data.hits.total.value }}</h2>\n                 </sw-card>\n                <sw-card :title="$t(\'sisi-backend-search.result\')" large>\n                    <div class="inner-wrapper"  v-on:scroll="scrollFunction">\n                        <div class="sw-loader" v-bind:style="{display:icon}">\n                            <div class="sw-loader__container" style="width: 32px; height: 32px;">\n                                <svg width="32px" height="32px" viewBox="0 0 66 66" xmlns="http://www.w3.org/2000/svg" class="sw-loader__element"><circle fill="none" stroke-width="6" stroke-linecap="round" cx="33" cy="33" r="30" class="sw-loader__path"></circle></svg>\n                            </div>\n                        </div>\n                    <div v-if="!result.data"> {{ $t(\'sisi-backend-search.noitem\') }}</div>\n                    <div v-else>\n                        <div v-if="result.data.hits.hits">\n                           <sw-container columns="1fr 1fr" v-for="(item,index) in result.data.hits.hits" >\n                            <div v-if="index == result.data.hits.hits.length - 1" class="sisinone sisi-last-row"></div>\n                            <sw-card-section divider="right">\n                            <router-link :to="{ name: \'sw.product.detail\', params: { id: item._id } }">\n                                <div>{{ $t(\'sisi-backend-search.productname\') }} <strong>{{ item._source.product_name }}</strong></div>\n                                <div>{{ $t(\'sisi-backend-search.productid\') }} <strong>{{ item._id }}</strong></div>\n                             </router-link>\n                            </sw-card-section>\n                            <sw-card-section>\n                                <div>\n                                  <router-link :to="{ name: \'sw.product.detail\', params: { id: item._id } }">\n                                      <div v-for="(highlight,index) in item.highlight">\n                                          <div v-if="\n                                                   index !=\'product_name\'\n                                                && index !=\'product_description\'\n                                                && index !=\'product_ean\'\n                                                && index !=\'product_meta_title\'\n                                                && index !=\'product_productNumber\'">\n                                          <span   v-for="(highlightItem,indexItem) in highlight"\n                                                 v-if="indexItem == 0 " v-html="highlightItem">\n                                          </span>\n                                          </div>\n                                          <div v-if ="index == \'product_productNumber\'">\n                                              {{ $t(\'sisi-backend-search.productnumber\') }}\n                                              :  <span  v-for="(highlightItem,indexItem) in highlight" v-html="highlightItem" v-if = "indexItem == 0"></span>\n                                          </div>\n                                          <div v-if ="index == \'product_ean\'">\n                                              {{ $t(\'sisi-backend-search.productean\') }} :\n                                              :  <span  v-for="(highlightItem,indexItem) in highlight" v-html="highlightItem" v-if = "indexItem == 0"></span>\n\n                                          </div>\n                                          <div v-if = "index == \'product_name\'">\n                                              {{ $t(\'sisi-backend-search.productname\') }}\n                                              : <span  v-for="(highlightItem,indexItem) in highlight" v-html="highlightItem" v-if = "indexItem == 0"></span>\n                                          </div>\n                                          <div v-if = "index == \'product_description\'">\n                                              {{ $t(\'sisi-backend-search.productdescription\') }}\n                                              :  <span  v-for="(highlightItem,indexItem) in highlight" v-html="highlightItem" v-if = "indexItem == 0"></span>\n\n                                          </div>\n                                       </div>\n                                    </router-link>\n                                </div>\n                            </sw-card-section>\n                        </sw-container>\n                        </div>\n                    </div>\n                    </div>\n                </sw-card>\n                </div>\n            {% endblock %}\n        </template>\n    </sw-page>\n{% endblock %}\n'},SwLI:function(e,t,n){"use strict";n.r(t);var i=n("lwsE"),r=n.n(i),s=n("W8MJ"),a=n.n(s),c=n("CkOj"),o=function(){function e(t,n,i){var s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"application/vnd.api+json";r()(this,e),this.httpClient=t,this.loginService=n,this.apiEndpoint=i,this.contentType=s}return a()(e,[{key:"getApiBasePath",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n="";return t&&t.length&&(n+="".concat(t,"/")),e&&e.length>0?"".concat(n).concat(this.apiEndpoint,"/").concat(e):"".concat(n).concat(this.apiEndpoint)}},{key:"getBasicHeaders",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={Accept:this.contentType,Authorization:"Bearer ".concat(this.loginService.getToken()),"Content-Type":"application/json"};return Object.assign({},t,e)}},{key:"apiEndpoint",get:function(){return this.endpoint},set:function(e){this.endpoint=e}},{key:"httpClient",get:function(){return this.client},set:function(e){this.client=e}},{key:"contentType",get:function(){return this.type},set:function(e){this.type=e}}],[{key:"handleResponse",value:function(t){if(null===t.data||void 0===t.data)return t;var n=t.data,i=t.headers;return i&&i["content-type"]&&"application/vnd.api+json"===i["content-type"]&&(n=e.parseJsonApiData(n)),n}},{key:"parseJsonApiData",value:function(e){return Object(c.a)(e)}},{key:"getVersionHeader",value:function(e){return{"sw-version-id":e}}}]),e}();t.default=o},fk1o:function(e,t){e.exports="{% block sw_search_bar_types_container %}\n\n{% endblock %}\n"},lO2t:function(e,t,n){"use strict";n.d(t,"b",(function(){return _}));var i=n("GoyQ"),r=n.n(i),s=n("YO3V"),a=n.n(s),c=n("E+oP"),o=n.n(c),l=n("wAXd"),d=n.n(l),h=n("Z0cm"),u=n.n(h),p=n("lSCD"),v=n.n(p),g=n("YiAA"),f=n.n(g),b=n("4qC0"),m=n.n(b),k=n("Znm+"),w=n.n(k),y=n("Y+p1"),O=n.n(y),S=n("UB5X"),j=n.n(S);function _(e){return void 0===e}t.a={isObject:r.a,isPlainObject:a.a,isEmpty:o.a,isRegExp:d.a,isArray:u.a,isFunction:v.a,isDate:f.a,isString:m.a,isBoolean:w.a,isEqual:O.a,isNumber:j.a,isUndefined:_}},lYO9:function(e,t,n){"use strict";n.d(t,"h",(function(){return w})),n.d(t,"i",(function(){return y})),n.d(t,"a",(function(){return O})),n.d(t,"d",(function(){return S})),n.d(t,"k",(function(){return j})),n.d(t,"j",(function(){return _})),n.d(t,"g",(function(){return x})),n.d(t,"b",(function(){return P})),n.d(t,"c",(function(){return E})),n.d(t,"f",(function(){return I})),n.d(t,"e",(function(){return A}));var i=n("lSNA"),r=n.n(i),s=n("QkVN"),a=n.n(s),c=n("JBE3"),o=n.n(c),l=n("BkRI"),d=n.n(l),h=n("mwIZ"),u=n.n(h),p=n("D1y2"),v=n.n(p),g=n("JZM8"),f=n.n(g),b=n("lO2t");function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function k(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){r()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}a.a,a.a,d.a,u.a,v.a,f.a;var w=a.a,y=o.a,O=d.a,S=u.a,j=v.a,_=f.a;function x(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function P(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return JSON.parse(JSON.stringify(e))}function E(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return y(e,t,(function(e,t){if(Array.isArray(e))return e.concat(t)}))}function I(e,t){return e===t?{}:b.a.isObject(e)&&b.a.isObject(t)?b.a.isDate(e)||b.a.isDate(t)?e.valueOf()===t.valueOf()?{}:t:Object.keys(t).reduce((function(n,i){if(!x(e,i))return k(k({},n),{},r()({},i,t[i]));if(b.a.isArray(t[i])){var s=A(e[i],t[i]);return Object.keys(s).length>0?k(k({},n),{},r()({},i,t[i])):n}if(b.a.isObject(t[i])){var a=I(e[i],t[i]);return!b.a.isObject(a)||Object.keys(a).length>0?k(k({},n),{},r()({},i,a)):n}return e[i]!==t[i]?k(k({},n),{},r()({},i,t[i])):n}),{}):t}function A(e,t){if(e===t)return[];if(!b.a.isArray(e)||!b.a.isArray(t))return t;if(e.length<=0&&t.length<=0)return[];if(e.length!==t.length)return t;if(!b.a.isObject(t[0]))return t.filter((function(t){return!e.includes(t)}));var n=[];return t.forEach((function(i,r){var s=I(e[r],t[r]);Object.keys(s).length>0&&n.push(t[r])})),n}},pgcR:function(e,t,n){}},[["3100","runtime","vendors-node"]]]);